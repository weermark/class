# 數位鑑識

[政府機關（構）資安事件數位證據保全標準作業程序](https://www.rootlaw.com.tw/LawArticle.aspx?LawID=A040020001003400-1040804)

## 資安事件因應措施

1. 事前防範
    * 創造麻煩
       * 使事件易發現
       * 使證據能保留
> 準備是為了識別
2. 事中應變
    * Invident Response (IR) 阻止傷害擴大，控制損失
3. 事後處置
    * Root Cause (根因分析)
        * 內部: 弱點、零日
        * 外部: IOC、IOA
    * 監控，避免再發生
    * 分享 -> 區域聯防

## 鑑識流程

```
Incident -> Meeting -> Incident Response
                |
                -----> First Cookie -> Image -> Analysis -> Report
```

### Incident

* Identify
    * signature (特徵)
* Report
    * level (嚴重程度)
* Scope
    * Domain (事件影響範圍)
    * Risk (風險評估)

### Meeting

* Contract (資安合約公司協助)
* Task force (成立小組應對)
* PR, CSO (資安長)
* Incident Management

### Incident Response

*Useful Response*

1. power, network, shutdown
2. Backup Recovery, Disaster Recovery (DR) site
3. Security Posture Assessment (資安健診)
4. Evidence Preservation

### First Cookie (第一個線索)

* Memory
    * Physical
    * Virtual
        * pagefile.sys
        * hiberfil.sys
        * swap (Linux)
* Network
* Process
* System
* Artifacts (一切人為事物)

#### tool

* Memory
    * Image
        * FTK Imager Lite
        * EnCase Imager
        * Magnet Forensic
        * Bulksoft
    * Analysis
        * Bulk Extractor
        * Volatility Forensic

#### Relationship:

* Evidence to Evidence/meta data (找到證據與證據間的關係)
* Incident to Account (找到造成事件的使用者)
* (Acount to Human) (從使用者肉搜真人，為警方職責)

### Image

* Evidence file format (E01, L01)
    * Bit by Bit String Copy
* RAW Image (raw, rso, mem, dd...)

### Analysis

* known *"有"就是結果*
    * keyword search
    * HASH
* unknown *不確定範圍，從正常找異常*
    * Recovery
    * File Signature
    * Artifacts

### Report

* Attack Source
* IP, MAC
* Attack vuln
* Timeline (one of Evidence)

## 檔案清除

* 反鑑識
* 保護秘密

程度:
1. Encryption
    * File, ex. vera crypt
    * Partition/HD, ex. TPM (BIOS Lock)
2. File level wipe, ex. File Shredder (Need Double Confirm 00)
3. Format partition, ex. EnCase, Falcon, Dossier, low-level Format
    * fast 
        * Modified FAT to E5
    * non-fast
        * Modified FAT
        * Bad Block Check
        * Wipe
4. Physical
    * 碎
    * 燒
    * 融
    * 磁

Note: Recuva (還原工具)

# 法律
## 刑法第36章妨害電腦使用罪章

刑法 | 內容 | 罰則
---|---|---
358 | 無故***輸入***他人帳號密碼、***破解***使用電腦之保護措施或***利用***電腦系統之漏洞，而入侵他人之電腦或其相關設備者 | 處三年以下有期徒刑、拘役或科或併科十萬元以下罰金。
359 | 無故***取得、刪除或變更***他人電腦或其相關設備之電磁紀錄，致生損害於公眾或他人者 | 處五年以下有期徒、拘役或科或併科二十萬元以下罰金。
360 | 無故以***電腦程式或其他電磁方式***干擾他人電腦或其相關設備，致生損害於公眾或他人者| 處三年以下有期徒、拘役或科或併科十萬元以下罰金。
362 | ***製作***專供犯本章之罪之電腦程式，而供自己或他人犯本章之罪，致生損害於公眾或他人者 | 處五年以下有期徒刑、拘役或科或併科二十萬元以下罰金。

361. 對於公務機關之電腦或其相關設備犯前三條之罪者，加重其刑至二分之一。
363. 第三百五十八條至第三百六十條之罪，須告訴乃論。

### 整理

製作(惡意程式)|使用(惡意程式)|破解|增刪查改|
---|----|----|----
362|360|358|359

### 範例

Jimmy使用自製的惡意程式利用系統漏洞破解某某政府機關層層保護的電腦主機，竄改其中關於Jimmy的電磁紀錄。

* 自製惡意程式 -> 362
* 使用惡意程式 -> 360
* 利用系統漏洞、破解 -> 358
* 竄改電磁紀錄 -> 359
* 政府機關 -> 361

## 營業祕密法

* 秘密性質
* 具有價值
* 有防護措施
